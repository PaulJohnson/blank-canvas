<html>
    <head>
        <title>Blank Canvas</title>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="jquery-json.js"></script>
        <script type="text/javascript" src="kansas-comet.js"></script>
    </head>
    <body style="padding: 0px; margin: 0px; border:0px">
        <div id="canvas"></div>
        <script type="text/javascript">
            var session = 0; // global session number
            function getContext() {
                    var canvas = document.getElementById("canvas");
                    if (canvas.getContext) {
                        return canvas.getContext("2d");
                    }
                    alert("no canvas");
            }
            function size(c) {
                    console.log("got to size")
                    return [c.canvas.width, c.canvas.height];
            }
            function toDataURL(c) {
                    // Has to go back up one level.
                    return c.canvas.toDataURL();
            }
            function register(name) {
                $(document).bind(name,function (e){
                        $.kc.event([name,e.which,e.pageX, e.pageY]);
                });
            }  
            function redraw() {
                $.ajax({ url: "/canvas/" + session,
                         type: "GET",
                         dataType: "script",
                         success: function success() {
                                 redraw();
                         }
                         }); 
             }
             
            $(document).ready(function() {
                // Make the canvas the size of the window
                var w = $(window).width();
                var h = $(window).height();

                $("#canvas").replaceWith(
                            '<canvas id="canvas" width="' + w + '" height="' + h +
                            '" style="border: blue solid 0px; padding: 0px; margin: 0px"></canvas>');

                $.kc.connect("/blank");

                /*
                 // start the server-side
                $.ajax({ url: "/start",
                         type: "POST",
                         contentType: "application/json; charset=utf-8",
                         data: $.toJSON([w,h]),
                         dataType: "script"}); 
                */
            });
        </script>
    </body>
</html>
